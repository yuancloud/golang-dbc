!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).candied={})}(this,(function(t){"use strict";function e(t){const e=t.matchAll(/(?<value>[0-9-]+) "(?<description>(?:[^"\\]|\\.)*)"/gi),a=new Map;for(const t of e)t.groups&&a.set(parseInt(t.groups.value,10),t.groups.description);return a}function a(t){return t.replace(";","").replace(/"/gi,"").trim()}function n(t,e){let a=0;switch(t){case"FLOAT":const t=e.match(/\s*(?<min>[0-9.]+)\s(?<max>[0-9.]+)\s*;/);t&&t.groups&&(a=parseFloat(t.groups.min));break;case"STRING":case"ENUM":break;case"HEX":const n=e.match(/\s*(?<min>[0-9.]+)\s(?<max>[0-9.]+)\s*;/);n&&n.groups&&(a=parseFloat(n.groups.min));break;case"INT":const i=e.match(/\s*(?<min>[0-9.]+)\s(?<max>[0-9.]+)\s*;/);i&&i.groups&&(a=parseFloat(i.groups.min))}return a}function i(t,e){let a=0;switch(t){case"FLOAT":const t=e.match(/\s*(?<min>[0-9.]+)\s(?<max>[0-9.]+)\s*;/);t&&t.groups&&(a=parseFloat(t.groups.max));break;case"STRING":case"ENUM":break;case"HEX":const n=e.match(/\s*(?<min>[0-9.]+)\s(?<max>[0-9.]+)\s*;/);n&&n.groups&&(a=parseFloat(n.groups.max));break;case"INT":const i=e.match(/\s*(?<min>[0-9.]+)\s(?<max>[0-9.]+)\s*;/);i&&i.groups&&(a=parseFloat(i.groups.max))}return a}function r(t,e){if("ENUM"!==t)return[];return e.replace(";","").split(",").map((t=>t.replace(/"/gi,"").trim()))}var s;!function(t){t.Choice_1="Choice_1",t.Choice_2="Choice_2",t.Choice_3="Choice_3",t.Choice_4="Choice_4",t.Choice_5="Choice_5",t.Choice_6="Choice_6",t.Choice_7="Choice_7",t.Choice_8="Choice_8",t.Choice_9="Choice_9",t.Choice_10="Choice_10",t.Choice_11="Choice_11",t.Choice_12="Choice_12",t.Choice_13="Choice_13",t.Choice_14="Choice_14",t.Choice_15="Choice_15",t.Choice_16="Choice_16",t.Choice_17="Choice_17",t.Choice_18="Choice_18",t.Choice_19="Choice_19",t.Choice_20="Choice_20",t.Choice_21="Choice_21",t.Choice_22="Choice_22",t.Choice_23="Choice_23",t.Choice_24="Choice_24",t.Choice_25="Choice_25",t.Choice_26="Choice_26",t.Choice_27="Choice_27",t.Choice_28="Choice_28",t.BlankLine="BlankLine",t.CanSignalGroup="CanSignalGroup",t.CanSignalGroup_$0="CanSignalGroup_$0",t.CanSignalGroup_$1="CanSignalGroup_$1",t.CanSignalGroup_$2="CanSignalGroup_$2",t.CanSignalGroup_$3="CanSignalGroup_$3",t.MessageTransmitter="MessageTransmitter",t.MessageTransmitter_$0="MessageTransmitter_$0",t.MessageTransmitter_$1="MessageTransmitter_$1",t.CanEnvironmentVariable="CanEnvironmentVariable",t.CanEnvironmentVariable_$0="CanEnvironmentVariable_$0",t.CanEnvironmentVariable_$1="CanEnvironmentVariable_$1",t.CanEnvironmentVariable_$2="CanEnvironmentVariable_$2",t.CanEnvironmentVariable_$3="CanEnvironmentVariable_$3",t.CanEnvironmentVariable_$4="CanEnvironmentVariable_$4",t.CanEnvironmentVariable_$5="CanEnvironmentVariable_$5",t.CanEnvironmentVariable_$6="CanEnvironmentVariable_$6",t.CanEnvironmentVariable_$7="CanEnvironmentVariable_$7",t.CanEnvironmentVariable_$8="CanEnvironmentVariable_$8",t.EnvironmentVarData="EnvironmentVarData",t.EnvironmentVarData_$0="EnvironmentVarData_$0",t.EnvironmentVarData_$1="EnvironmentVarData_$1",t.EnvironmentVariableComment="EnvironmentVariableComment",t.EnvironmentVariableComment_$0="EnvironmentVariableComment_$0",t.EnvironmentVariableComment_$1="EnvironmentVariableComment_$1",t.Version="Version",t.Version_$0="Version_$0",t.NewSymbol="NewSymbol",t.BusSpeed="BusSpeed",t.NewSymbolValue="NewSymbolValue",t.NewSymbolValue_$0="NewSymbolValue_$0",t.CanNode="CanNode",t.CanNode_$0="CanNode_$0",t.CanMessage="CanMessage",t.CanMessage_$0="CanMessage_$0",t.CanMessage_$1="CanMessage_$1",t.CanMessage_$2="CanMessage_$2",t.CanMessage_$3="CanMessage_$3",t.CanSignal="CanSignal",t.CanSignal_$0="CanSignal_$0",t.CanSignal_$1="CanSignal_$1",t.CanSignal_$2="CanSignal_$2",t.CanSignal_$3="CanSignal_$3",t.CanSignal_$4="CanSignal_$4",t.CanSignal_$5="CanSignal_$5",t.CanSignal_$6="CanSignal_$6",t.CanSignal_$7="CanSignal_$7",t.CanSignal_$8="CanSignal_$8",t.CanSignal_$9="CanSignal_$9",t.CanSignal_$10="CanSignal_$10",t.CanSignal_$11="CanSignal_$11",t.ValTable="ValTable",t.ValTable_$0="ValTable_$0",t.ValTable_$1="ValTable_$1",t.Val="Val",t.Val_$0="Val_$0",t.Val_$1="Val_$1",t.Val_$2="Val_$2",t.EnvironmentVal="EnvironmentVal",t.EnvironmentVal_$0="EnvironmentVal_$0",t.EnvironmentVal_$1="EnvironmentVal_$1",t.Comment="Comment",t.Comment_$0="Comment_$0",t.SignalComment="SignalComment",t.SignalComment_$0="SignalComment_$0",t.SignalComment_$1="SignalComment_$1",t.SignalComment_$2="SignalComment_$2",t.MessageComment="MessageComment",t.MessageComment_$0="MessageComment_$0",t.MessageComment_$1="MessageComment_$1",t.NodeComment="NodeComment",t.NodeComment_$0="NodeComment_$0",t.NodeComment_$1="NodeComment_$1",t.GlobalAttribute="GlobalAttribute",t.GlobalAttribute_$0="GlobalAttribute_$0",t.GlobalAttribute_$1="GlobalAttribute_$1",t.GlobalAttribute_$2="GlobalAttribute_$2",t.MessageAttribute="MessageAttribute",t.MessageAttribute_$0="MessageAttribute_$0",t.MessageAttribute_$1="MessageAttribute_$1",t.MessageAttribute_$2="MessageAttribute_$2",t.EnvironmentAttribute="EnvironmentAttribute",t.EnvironmentAttribute_$0="EnvironmentAttribute_$0",t.EnvironmentAttribute_$1="EnvironmentAttribute_$1",t.EnvironmentAttribute_$2="EnvironmentAttribute_$2",t.NodeAttribute="NodeAttribute",t.NodeAttribute_$0="NodeAttribute_$0",t.NodeAttribute_$1="NodeAttribute_$1",t.NodeAttribute_$2="NodeAttribute_$2",t.SignalAttribute="SignalAttribute",t.SignalAttribute_$0="SignalAttribute_$0",t.SignalAttribute_$1="SignalAttribute_$1",t.SignalAttribute_$2="SignalAttribute_$2",t.AttributeDefault="AttributeDefault",t.AttributeDefault_$0="AttributeDefault_$0",t.AttributeDefault_$1="AttributeDefault_$1",t.AttributeValue="AttributeValue",t.AttributeValue_$0="AttributeValue_$0",t.AttributeValue_$1="AttributeValue_$1",t.SigValType="SigValType",t.SigValType_$0="SigValType_$0",t.SigValType_$1="SigValType_$1",t.SigValType_$2="SigValType_$2",t.$EOF="$EOF"}(s||(s={}));class l{constructor(t,e,a,n){this.kind=s.CanSignalGroup,this.raw_id=t,this.name=e,this.raw_group_number=a,this.raw_signal_string=n,this.signals=n.replace(";","").split(" "),this.id=parseInt(t,10),this.group_number=parseInt(a,10)}}class c{constructor(t,e){this.kind=s.MessageTransmitter,this.raw_id=t,this.raw_nodes=e,this.id=parseInt(t,10),this.nodes=e.replace(";","").split(",")}}class o{constructor(t,e,n,i,r,l,c,o,h){this.kind=s.CanEnvironmentVariable,this.name=t,this.type=e,this.raw_min=n,this.raw_max=i,this.raw_unit=r,this.raw_inital_value=l,this.raw_ev_id=c,this.access_type=o,this.node=h,this.min=parseFloat(n),this.max=parseFloat(i),this.unit=a(r),this.initial_value=parseFloat(l),this.ev_id=parseInt(c,10)}}class h{constructor(t,e){this.kind=s.EnvironmentVarData,this.name=t,this.raw_value=e,this.value=parseInt(e)}}class u{constructor(t,e){this.kind=s.EnvironmentVariableComment,this.name=t,this.raw_comment=e,this.comment=a(e)}}class m{constructor(t){this.kind=s.Version,this.raw_version=t,this.version=a(t)}}class g{constructor(t){this.kind=s.CanNode,this.raw_node_string=t,this.node_names=t.split(" ")}}class d{constructor(t,e,a,n){this.kind=s.CanMessage,this.raw_id=t,this.name=e,this.raw_dlc=a,this.node=n,this.id=parseInt(t,10),this.dlc=parseInt(a,10)}}class p{constructor(t,e,n,i,r,l,c,o,h,u,m,g){this.kind=s.CanSignal,this.name=t,this.multiplex=e,this.raw_start_bit=n,this.raw_length=i,this.raw_endian=r,this.raw_signed=l,this.raw_factor=c,this.raw_offset=o,this.raw_min=h,this.raw_max=u,this.raw_unit=m,this.raw_node_str=g,this.unit=a(m),this.nodes=g.trim().split(","),this.start_bit=parseInt(n,10),this.length=parseInt(i,10),this.endian="1"===r?"Intel":"Motorola",this.signed="-"===l,this.factor=parseFloat(c),this.offset=parseFloat(o),this.min=parseFloat(h),this.max=parseFloat(u)}}class _{constructor(t,a){this.kind=s.ValTable,this.name=t,this.raw_table=a,this.enum=e(a.replace(";",""))}}class b{constructor(t,a,n){this.kind=s.Val,this.raw_id=t,this.name=a,this.raw_table=n,this.id=parseInt(t,10),this.enum=e(n.replace(";",""))}}class S{constructor(t,a){this.kind=s.EnvironmentVal,this.name=t,this.raw_table=a,this.enum=e(a.replace(";",""))}}class w{constructor(t){this.kind=s.Comment,this.raw_comment=t,this.comment=a(t)}}class A{constructor(t,e,n){this.kind=s.SignalComment,this.raw_id=t,this.name=e,this.raw_comment=n,this.comment=a(n),this.id=parseInt(t,10)}}class ${constructor(t,e){this.kind=s.MessageComment,this.raw_id=t,this.raw_comment=e,this.comment=a(e),this.id=parseInt(t,10)}}class C{constructor(t,e){this.kind=s.NodeComment,this.name=t,this.raw_comment=e,this.comment=a(e)}}class f{constructor(t,e,a){this.kind=s.GlobalAttribute,this.name=t,this.type=e,this.raw_value=a,this.min=n(e,a),this.max=i(e,a),this.enum=r(e,a)}}class V{constructor(t,e,a){this.kind=s.MessageAttribute,this.name=t,this.type=e,this.raw_value=a,this.min=n(e,a),this.max=i(e,a),this.enum=r(e,a)}}class v{constructor(t,e,a){this.kind=s.EnvironmentAttribute,this.name=t,this.type=e,this.raw_value=a,this.min=n(e,a),this.max=i(e,a),this.enum=r(e,a)}}class x{constructor(t,e,a){this.kind=s.NodeAttribute,this.name=t,this.type=e,this.raw_value=a,this.min=n(e,a),this.max=i(e,a),this.enum=r(e,a)}}class E{constructor(t,e,a){this.kind=s.SignalAttribute,this.name=t,this.type=e,this.raw_value=a,this.min=n(e,a),this.max=i(e,a),this.enum=r(e,a)}}class y{constructor(t,e){this.kind=s.AttributeDefault,this.name=t,this.raw_value=e,this.value=a(e)}}class T{constructor(t,e){this.kind=s.AttributeValue,this.name=t,this.raw=e,this.type=function(t){const e=t.match(/BO_|BU_|SG_|EV_/);if(!e)return"Global";switch(null==e?void 0:e.toString()){case"BO_":return"Message";case"BU_":return"Node";case"SG_":return"Signal";case"EV_":return"EnvironmentVariable";default:return"Global"}}(e),this.node=(()=>function(t,e){let a;switch(t){case"Message":case"Signal":return"";case"Node":if(a=e.match(/BU_\s(?<node>[a-zA-Z0-9_]+)\s(?<value>.*)\s*;/),a&&a.groups)return a.groups.node;case"Global":return"";case"EnvironmentVariable":if(a=e.match(/EV_\s(?<node>[a-zA-Z0-9_]+)\s(?<value>.*)\s*;/),a&&a.groups)return a.groups.node;default:return""}}(this.type,e))(),this.id=(()=>parseInt(function(t,e){let a;switch(t){case"Message":if(a=e.match(/BO_\s(?<id>[0-9]+)\s(?<value>.*);/),a&&a.groups)return a.groups.id;case"Signal":if(a=e.match(/SG_\s(?<id>[0-9]+)\s(?<signalName>[a-zA-Z0-9_]+)\s(?<value>.*);/),a&&a.groups)return a.groups.id;default:return""}}(this.type,e),10))(),this.signal=(()=>function(t,e){let a,n="";switch(t){case"Message":break;case"Signal":a=e.match(/SG_\s(?<id>[0-9]+)\s(?<signalName>[a-zA-Z0-9_]+)\s(?<value>.*);/),a&&a.groups&&(n=a.groups.signalName)}return n}(this.type,e))(),this.value=(()=>function(t,e){let n;switch(t){case"Message":if(n=e.match(/BO_\s(?<id>[0-9]+)\s(?<value>.*);/),n&&n.groups)return a(n.groups.value);case"Signal":if(n=e.match(/SG_\s(?<id>[0-9]+)\s(?<signalName>[a-zA-Z0-9_]+)\s(?<value>.*);/),n&&n.groups)return a(n.groups.value);case"Node":if(n=e.match(/BU_\s(?<node>[a-zA-Z0-9_]+)\s(?<value>.*)\s*;/),n&&n.groups)return a(n.groups.value);case"Global":if(n=e.match(/(?<value>.*)\s*;/),n&&n.groups)return a(n.groups.value);case"EnvironmentVariable":if(n=e.match(/EV_\s(?<node>[a-zA-Z0-9_]+)\s(?<value>.*)\s*;/),n&&n.groups)return a(n.groups.value);default:return""}}(this.type,e))()}}class N{constructor(t,e,a){this.kind=s.SigValType,this.raw_id=t,this.name=e,this.raw_type=a,this.id=parseInt(t,10),this.type=parseInt(a,10)}}class M{constructor(t){this.negating=!1,this.memoSafe=!0,this.pos={overallPos:0,line:1,offset:0},this.input=t}reset(t){this.pos=t}finished(){return this.pos.overallPos===this.input.length}clearMemos(){}matchChoice(t,e){return this.choice([()=>this.matchChoice_1(t+1,e),()=>this.matchChoice_2(t+1,e),()=>this.matchChoice_3(t+1,e),()=>this.matchChoice_4(t+1,e),()=>this.matchChoice_5(t+1,e),()=>this.matchChoice_6(t+1,e),()=>this.matchChoice_7(t+1,e),()=>this.matchChoice_8(t+1,e),()=>this.matchChoice_9(t+1,e),()=>this.matchChoice_10(t+1,e),()=>this.matchChoice_11(t+1,e),()=>this.matchChoice_12(t+1,e),()=>this.matchChoice_13(t+1,e),()=>this.matchChoice_14(t+1,e),()=>this.matchChoice_15(t+1,e),()=>this.matchChoice_16(t+1,e),()=>this.matchChoice_17(t+1,e),()=>this.matchChoice_18(t+1,e),()=>this.matchChoice_19(t+1,e),()=>this.matchChoice_20(t+1,e),()=>this.matchChoice_21(t+1,e),()=>this.matchChoice_22(t+1,e),()=>this.matchChoice_23(t+1,e),()=>this.matchChoice_24(t+1,e),()=>this.matchChoice_25(t+1,e),()=>this.matchChoice_26(t+1,e),()=>this.matchChoice_27(t+1,e),()=>this.matchChoice_28(t+1,e)])}matchChoice_1(t,e){return this.matchCanNode(t+1,e)}matchChoice_2(t,e){return this.matchCanMessage(t+1,e)}matchChoice_3(t,e){return this.matchCanSignal(t+1,e)}matchChoice_4(t,e){return this.matchValTable(t+1,e)}matchChoice_5(t,e){return this.matchVal(t+1,e)}matchChoice_6(t,e){return this.matchSignalComment(t+1,e)}matchChoice_7(t,e){return this.matchMessageComment(t+1,e)}matchChoice_8(t,e){return this.matchNodeComment(t+1,e)}matchChoice_9(t,e){return this.matchGlobalAttribute(t+1,e)}matchChoice_10(t,e){return this.matchMessageAttribute(t+1,e)}matchChoice_11(t,e){return this.matchSignalAttribute(t+1,e)}matchChoice_12(t,e){return this.matchNodeAttribute(t+1,e)}matchChoice_13(t,e){return this.matchAttributeDefault(t+1,e)}matchChoice_14(t,e){return this.matchAttributeValue(t+1,e)}matchChoice_15(t,e){return this.matchVersion(t+1,e)}matchChoice_16(t,e){return this.matchNewSymbolValue(t+1,e)}matchChoice_17(t,e){return this.matchBlankLine(t+1,e)}matchChoice_18(t,e){return this.matchNewSymbol(t+1,e)}matchChoice_19(t,e){return this.matchBusSpeed(t+1,e)}matchChoice_20(t,e){return this.matchComment(t+1,e)}matchChoice_21(t,e){return this.matchCanEnvironmentVariable(t+1,e)}matchChoice_22(t,e){return this.matchEnvironmentVarData(t+1,e)}matchChoice_23(t,e){return this.matchEnvironmentVariableComment(t+1,e)}matchChoice_24(t,e){return this.matchMessageTransmitter(t+1,e)}matchChoice_25(t,e){return this.matchEnvironmentAttribute(t+1,e)}matchChoice_26(t,e){return this.matchEnvironmentVal(t+1,e)}matchChoice_27(t,e){return this.matchCanSignalGroup(t+1,e)}matchChoice_28(t,e){return this.matchSigValType(t+1,e)}matchBlankLine(t,e){return this.run(t,(()=>{let a=null;return null!==this.regexAccept(String.raw`(?:)`,t+1,e)&&null!==this.match$EOF(e)&&(a={kind:s.BlankLine}),a}))}matchCanSignalGroup(t,e){return this.run(t,(()=>{let a,n,i,r,s=null;return null!==this.regexAccept(String.raw`(?:SIG_GROUP_\s+)`,t+1,e)&&null!==(a=this.matchCanSignalGroup_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(n=this.matchCanSignalGroup_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(i=this.matchCanSignalGroup_$2(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+:\s*)`,t+1,e)&&null!==(r=this.matchCanSignalGroup_$3(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*)`,t+1,e)&&(s=new l(a,n,i,r)),s}))}matchCanSignalGroup_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchCanSignalGroup_$1(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchCanSignalGroup_$2(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchCanSignalGroup_$3(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_\s]*)`,t+1,e)}matchMessageTransmitter(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:BO_TX_BU_\s+)`,t+1,e)&&null!==(a=this.matchMessageTransmitter_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*:\s*)`,t+1,e)&&null!==(n=this.matchMessageTransmitter_$1(t+1,e))&&(i=new c(a,n)),i}))}matchMessageTransmitter_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchMessageTransmitter_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchCanEnvironmentVariable(t,e){return this.run(t,(()=>{let a,n,i,r,s,l,c,h,u,m=null;return null!==this.regexAccept(String.raw`(?:EV_\s+)`,t+1,e)&&null!==(a=this.matchCanEnvironmentVariable_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*:\s*)`,t+1,e)&&null!==(n=this.matchCanEnvironmentVariable_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+\[)`,t+1,e)&&null!==(i=this.matchCanEnvironmentVariable_$2(t+1,e))&&null!==this.regexAccept(String.raw`(?:\|)`,t+1,e)&&null!==(r=this.matchCanEnvironmentVariable_$3(t+1,e))&&null!==this.regexAccept(String.raw`(?:\]\s)`,t+1,e)&&null!==(s=this.matchCanEnvironmentVariable_$4(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(l=this.matchCanEnvironmentVariable_$5(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(c=this.matchCanEnvironmentVariable_$6(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(h=this.matchCanEnvironmentVariable_$7(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(u=this.matchCanEnvironmentVariable_$8(t+1,e))&&(m=new o(a,n,i,r,s,l,c,h,u)),m}))}matchCanEnvironmentVariable_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchCanEnvironmentVariable_$1(t,e){return this.regexAccept(String.raw`(?:0|1|2)`,t+1,e)}matchCanEnvironmentVariable_$2(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanEnvironmentVariable_$3(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanEnvironmentVariable_$4(t,e){return this.regexAccept(String.raw`(?:".*")`,t+1,e)}matchCanEnvironmentVariable_$5(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanEnvironmentVariable_$6(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchCanEnvironmentVariable_$7(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchCanEnvironmentVariable_$8(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchEnvironmentVarData(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:ENVVAR_DATA_\s+)`,t+1,e)&&null!==(a=this.matchEnvironmentVarData_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*:\s*)`,t+1,e)&&null!==(n=this.matchEnvironmentVarData_$1(t+1,e))&&(i=new h(a,n)),i}))}matchEnvironmentVarData_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchEnvironmentVarData_$1(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchEnvironmentVariableComment(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:CM_ EV_\s+)`,t+1,e)&&null!==(a=this.matchEnvironmentVariableComment_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchEnvironmentVariableComment_$1(t+1,e))&&(i=new u(a,n)),i}))}matchEnvironmentVariableComment_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchEnvironmentVariableComment_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchVersion(t,e){return this.run(t,(()=>{let a,n=null;return null!==this.regexAccept(String.raw`(?:VERSION)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(a=this.matchVersion_$0(t+1,e))&&(n=new m(a)),n}))}matchVersion_$0(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchNewSymbol(t,e){return this.regexAccept(String.raw`(?:NS_\s*:)`,t+1,e)}matchBusSpeed(t,e){return this.regexAccept(String.raw`(?:BS_:)`,t+1,e)}matchNewSymbolValue(t,e){return this.run(t,(()=>{let a,n=null;return null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(a=this.matchNewSymbolValue_$0(t+1,e))&&(this.regexAccept(String.raw`(?:$)`,t+1,e),1)&&(n={kind:s.NewSymbolValue,symbol:a}),n}))}matchNewSymbolValue_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z_]+_)`,t+1,e)}matchCanNode(t,e){return this.run(t,(()=>{let a,n=null;return null!==this.regexAccept(String.raw`(?:BU_:\s*)`,t+1,e)&&null!==(a=this.matchCanNode_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*)`,t+1,e)&&(this.regexAccept(String.raw`(?:;)`,t+1,e),1)&&(n=new g(a)),n}))}matchCanNode_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_\s]*)`,t+1,e)}matchCanMessage(t,e){return this.run(t,(()=>{let a,n,i,r,s=null;return null!==this.regexAccept(String.raw`(?:BO_\s)`,t+1,e)&&null!==(a=this.matchCanMessage_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*)`,t+1,e)&&null!==(n=this.matchCanMessage_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?::\s*)`,t+1,e)&&null!==(i=this.matchCanMessage_$2(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*)`,t+1,e)&&null!==(r=this.matchCanMessage_$3(t+1,e))&&(s=new d(a,n,i,r)),s}))}matchCanMessage_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchCanMessage_$1(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]*)`,t+1,e)}matchCanMessage_$2(t,e){return this.regexAccept(String.raw`(?:[0-9])`,t+1,e)}matchCanMessage_$3(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]*)`,t+1,e)}matchCanSignal(t,e){return this.run(t,(()=>{let a,n,i,r,s,l,c,o,h,u,m,g,d=null;return null!==this.regexAccept(String.raw`(?:\s*SG_\s)`,t+1,e)&&null!==(a=this.matchCanSignal_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*)`,t+1,e)&&null!==(n=this.matchCanSignal_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*:\s)`,t+1,e)&&null!==(i=this.matchCanSignal_$2(t+1,e))&&null!==this.regexAccept(String.raw`(?:\|)`,t+1,e)&&null!==(r=this.matchCanSignal_$3(t+1,e))&&null!==this.regexAccept(String.raw`(?:@)`,t+1,e)&&null!==(s=this.matchCanSignal_$4(t+1,e))&&null!==(l=this.matchCanSignal_$5(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s\()`,t+1,e)&&null!==(c=this.matchCanSignal_$6(t+1,e))&&null!==this.regexAccept(String.raw`(?:,)`,t+1,e)&&null!==(o=this.matchCanSignal_$7(t+1,e))&&null!==this.regexAccept(String.raw`(?:\)\s\[)`,t+1,e)&&null!==(h=this.matchCanSignal_$8(t+1,e))&&null!==this.regexAccept(String.raw`(?:\|)`,t+1,e)&&null!==(u=this.matchCanSignal_$9(t+1,e))&&null!==this.regexAccept(String.raw`(?:\]\s)`,t+1,e)&&null!==(m=this.matchCanSignal_$10(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(g=this.matchCanSignal_$11(t+1,e))&&(d=new p(a,n,i,r,s,l,c,o,h,u,m,g)),d}))}matchCanSignal_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchCanSignal_$1(t,e){return this.regexAccept(String.raw`(?:M|[m0-9]*|\s)`,t+1,e)}matchCanSignal_$2(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchCanSignal_$3(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchCanSignal_$4(t,e){return this.regexAccept(String.raw`(?:[1|0])`,t+1,e)}matchCanSignal_$5(t,e){return this.regexAccept(String.raw`(?:[+|-])`,t+1,e)}matchCanSignal_$6(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanSignal_$7(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanSignal_$8(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanSignal_$9(t,e){return this.regexAccept(String.raw`(?:[\-0-9.]+)`,t+1,e)}matchCanSignal_$10(t,e){return this.regexAccept(String.raw`(?:".*")`,t+1,e)}matchCanSignal_$11(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchValTable(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:VAL_TABLE_\s)`,t+1,e)&&null!==(a=this.matchValTable_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchValTable_$1(t+1,e))&&(i=new _(a,n)),i}))}matchValTable_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchValTable_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchVal(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:VAL_\s)`,t+1,e)&&null!==(a=this.matchVal_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchVal_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(i=this.matchVal_$2(t+1,e))&&(r=new b(a,n,i)),r}))}matchVal_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchVal_$1(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchVal_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchEnvironmentVal(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:VAL_\s)`,t+1,e)&&null!==this.negate((()=>this.regexAccept(String.raw`(?:0-9)`,t+1,e)))&&null!==(a=this.matchEnvironmentVal_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchEnvironmentVal_$1(t+1,e))&&(i=new S(a,n)),i}))}matchEnvironmentVal_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchEnvironmentVal_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchComment(t,e){return this.run(t,(()=>{let a,n=null;return null!==this.regexAccept(String.raw`(?:CM_\s)`,t+1,e)&&null!==this.negate((()=>this.regexAccept(String.raw`(?:[SG_|BO_|BU_|EV_])`,t+1,e)))&&null!==(a=this.matchComment_$0(t+1,e))&&(n=new w(a)),n}))}matchComment_$0(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchSignalComment(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:CM_ SG_\s)`,t+1,e)&&null!==(a=this.matchSignalComment_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchSignalComment_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(i=this.matchSignalComment_$2(t+1,e))&&(r=new A(a,n,i)),r}))}matchSignalComment_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchSignalComment_$1(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchSignalComment_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchMessageComment(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:CM_ BO_\s)`,t+1,e)&&null!==(a=this.matchMessageComment_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchMessageComment_$1(t+1,e))&&(i=new $(a,n)),i}))}matchMessageComment_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchMessageComment_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchNodeComment(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:CM_ BU_\s)`,t+1,e)&&null!==(a=this.matchNodeComment_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchNodeComment_$1(t+1,e))&&(i=new C(a,n)),i}))}matchNodeComment_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchNodeComment_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchGlobalAttribute(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:BA_DEF_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchGlobalAttribute_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchGlobalAttribute_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(i=this.matchGlobalAttribute_$2(t+1,e))&&(r=new f(a,n,i)),r}))}matchGlobalAttribute_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchGlobalAttribute_$1(t,e){return this.regexAccept(String.raw`(?:[A-Z]+)`,t+1,e)}matchGlobalAttribute_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchMessageAttribute(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:BA_DEF_ BO_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchMessageAttribute_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchMessageAttribute_$1(t+1,e))&&(this.regexAccept(String.raw`(?:\s)`,t+1,e),1)&&null!==(i=this.matchMessageAttribute_$2(t+1,e))&&(r=new V(a,n,i)),r}))}matchMessageAttribute_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchMessageAttribute_$1(t,e){return this.regexAccept(String.raw`(?:[A-Z]+)`,t+1,e)}matchMessageAttribute_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchEnvironmentAttribute(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:BA_DEF_ EV_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchEnvironmentAttribute_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchEnvironmentAttribute_$1(t+1,e))&&(this.regexAccept(String.raw`(?:\s)`,t+1,e),1)&&null!==(i=this.matchEnvironmentAttribute_$2(t+1,e))&&(r=new v(a,n,i)),r}))}matchEnvironmentAttribute_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchEnvironmentAttribute_$1(t,e){return this.regexAccept(String.raw`(?:[A-Z]+)`,t+1,e)}matchEnvironmentAttribute_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchNodeAttribute(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:BA_DEF_ BU_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchNodeAttribute_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchNodeAttribute_$1(t+1,e))&&(this.regexAccept(String.raw`(?:\s)`,t+1,e),1)&&null!==(i=this.matchNodeAttribute_$2(t+1,e))&&(r=new x(a,n,i)),r}))}matchNodeAttribute_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchNodeAttribute_$1(t,e){return this.regexAccept(String.raw`(?:[A-Z]+)`,t+1,e)}matchNodeAttribute_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchSignalAttribute(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:BA_DEF_ SG_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchSignalAttribute_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchSignalAttribute_$1(t+1,e))&&(this.regexAccept(String.raw`(?:\s)`,t+1,e),1)&&null!==(i=this.matchSignalAttribute_$2(t+1,e))&&(r=new E(a,n,i)),r}))}matchSignalAttribute_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchSignalAttribute_$1(t,e){return this.regexAccept(String.raw`(?:[A-Z]+)`,t+1,e)}matchSignalAttribute_$2(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchAttributeDefault(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:BA_DEF_DEF_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchAttributeDefault_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchAttributeDefault_$1(t+1,e))&&(i=new y(a,n)),i}))}matchAttributeDefault_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchAttributeDefault_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchAttributeValue(t,e){return this.run(t,(()=>{let a,n,i=null;return null!==this.regexAccept(String.raw`(?:BA_\s+)`,t+1,e)&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==(a=this.matchAttributeValue_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:")`,t+1,e)&&null!==this.regexAccept(String.raw`(?:\s)`,t+1,e)&&null!==(n=this.matchAttributeValue_$1(t+1,e))&&(i=new T(a,n)),i}))}matchAttributeValue_$0(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchAttributeValue_$1(t,e){return this.regexAccept(String.raw`(?:.*)`,t+1,e)}matchSigValType(t,e){return this.run(t,(()=>{let a,n,i,r=null;return null!==this.regexAccept(String.raw`(?:SIG_VALTYPE_\s+)`,t+1,e)&&null!==(a=this.matchSigValType_$0(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s+)`,t+1,e)&&null!==(n=this.matchSigValType_$1(t+1,e))&&null!==this.regexAccept(String.raw`(?:\s*:\s*)`,t+1,e)&&null!==(i=this.matchSigValType_$2(t+1,e))&&(r=new N(a,n,i)),r}))}matchSigValType_$0(t,e){return this.regexAccept(String.raw`(?:[0-9]+)`,t+1,e)}matchSigValType_$1(t,e){return this.regexAccept(String.raw`(?:[a-zA-Z0-9_]+)`,t+1,e)}matchSigValType_$2(t,e){return this.regexAccept(String.raw`(?:1|2)`,t+1,e)}test(){const t=this.mark(),e=null!==this.matchChoice(0);return this.reset(t),e}parse(){const t=this.mark(),e=this.matchChoice(0);if(e)return{ast:e,errs:[]};this.reset(t);const a=new G;this.clearMemos(),this.matchChoice(0,a);const n=a.getErr();return{ast:e,errs:null!==n?[n]:[]}}mark(){return this.pos}loop(t,e=!1){const a=this.mark(),n=[];for(;;){const e=t();if(null===e)break;n.push(e)}return e||n.length>0?n:(this.reset(a),null)}run(t,e){const a=this.mark(),n=e();return null!==n?n:(this.reset(a),null)}choice(t){for(const e of t){const t=e();if(null!==t)return t}return null}regexAccept(t,e,a){return this.run(e,(()=>{const e=new RegExp(t,"y"),n=this.mark();e.lastIndex=n.overallPos;const i=this.tryConsume(e);return a&&a.record(n,i,{kind:"RegexMatch",literal:t.substring(3,t.length-1),negated:this.negating}),i}))}tryConsume(t){const e=t.exec(this.input);if(e){let a=0,n=-1;for(let t=0;t<e[0].length;++t)"\n"===e[0][t]&&(++a,n=t);return this.pos={overallPos:t.lastIndex,line:this.pos.line+a,offset:-1===n?this.pos.offset+e[0].length:e[0].length-n-1},e[0]}return null}noConsume(t){const e=this.mark(),a=t();return this.reset(e),a}negate(t){const e=this.mark(),a=this.negating;this.negating=!a;const n=t();return this.negating=a,this.reset(e),null===n||null}memoise(t,e){const a=this.mark(),n=e.get(a.overallPos);if(this.memoSafe&&void 0!==n)return this.reset(n[1]),n[0];const i=t();return this.memoSafe&&e.set(a.overallPos,[i,this.mark()]),i}match$EOF(t){const e=this.finished()?{kind:s.$EOF}:null;return t&&t.record(this.mark(),e,{kind:"EOF",negated:this.negating}),e}}class k{constructor(t,e){this.pos=t,this.expmatches=[...e]}toString(){return`Syntax Error at line ${this.pos.line}:${this.pos.offset}. Expected one of ${this.expmatches.map((t=>"EOF"===t.kind?" EOF":` ${t.negated?"not ":""}'${t.literal}'`))}`}}class G{constructor(){this.mxpos={overallPos:-1,line:-1,offset:-1},this.regexset=new Set,this.pmatches=[]}record(t,e,a){null===e!==a.negated&&(t.overallPos>this.mxpos.overallPos&&(this.mxpos=t,this.pmatches=[],this.regexset.clear()),this.mxpos.overallPos===t.overallPos&&("RegexMatch"===a.kind?(this.regexset.has(a.literal)||this.pmatches.push(a),this.regexset.add(a.literal)):this.pmatches.push(a)))}getErr(){return-1!==this.mxpos.overallPos?new k(this.mxpos,this.pmatches):null}}const B=(t,e,a=!1)=>{if(64===t&&a)return"double";if(32===t&&a)return"float";if(t<=8)return e?"int8":"uint8";if(t<=16)return e?"int16":"uint16";if(t<=32)return e?"int32":"uint32";if(t<=64)return e?"int64":"uint64";throw t>64?new Error(`Number of bits ${t} exceeds maximum possible data type`):new Error(`Could not compute data type from inputs: bits ->${t} signed-> ${e} float ->${a}`)};class I extends M{constructor(t){super(t),this.parseResult=this.parse()}updateData(t){if(this.hasKindProp(this.parseResult.ast))switch(this.parseResult.ast,this.parseResult.ast.kind){case s.CanMessage:this.addMessage(t,this.parseResult.ast);break;case s.CanSignal:this.addSignal(t,this.parseResult.ast);break;case s.Version:this.addVersion(t,this.parseResult.ast);break;case s.NewSymbolValue:this.addNewSymbolValue(t,this.parseResult.ast);break;case s.Val:this.addVal(t,this.parseResult.ast);break;case s.ValTable:this.addValTable(t,this.parseResult.ast);break;case s.AttributeValue:this.addAttributeValue(t,this.parseResult.ast);break;case s.AttributeDefault:this.addAttributeDefaultValue(t,this.parseResult.ast);break;case s.GlobalAttribute:this.addGlobalAttribute(t,this.parseResult.ast);break;case s.MessageAttribute:this.addMessageAttribute(t,this.parseResult.ast);break;case s.SignalAttribute:this.addSignalAttribute(t,this.parseResult.ast);break;case s.NodeAttribute:this.addNodeAttribute(t,this.parseResult.ast);break;case s.CanNode:this.addNode(t,this.parseResult.ast);break;case s.SignalComment:this.addSignalComment(t,this.parseResult.ast);break;case s.MessageComment:this.addMessageComment(t,this.parseResult.ast);break;case s.NodeComment:this.addNodeComment(t,this.parseResult.ast);break;case s.Comment:this.addComment(t,this.parseResult.ast);break;case s.CanEnvironmentVariable:this.addEnvironmentVariable(t,this.parseResult.ast);break;case s.EnvironmentAttribute:this.addEnvironmentAttribute(t,this.parseResult.ast);break;case s.EnvironmentVal:this.addEnvironmentVal(t,this.parseResult.ast);break;case s.EnvironmentVariableComment:this.addEnvironmentVariableComment(t,this.parseResult.ast);break;case s.EnvironmentVarData:this.addEnvironmentVariableData(t,this.parseResult.ast);break;case s.MessageTransmitter:this.addMessageTransmitter(t,this.parseResult.ast);break;case s.CanSignalGroup:this.addSignalGroup(t,this.parseResult.ast);break;case s.SigValType:this.addSignalValType(t,this.parseResult.ast)}return t}addComment(t,e){t.description=e.comment}addNode(t,e){e.node_names.forEach((e=>{const a={};a.name=e,a.description=null,a.attributes=new Map,""!==a.name&&t.nodes.set(e,a)}))}addEnvironmentVariableData(t,e){const a=t.environmentVariables.get(e.name);a&&(a.dataBytesLength=e.value)}addEnvironmentVariable(t,e){const a={};a.name=e.name,a.type=this.convert2EnvType(e.type),a.initialValue=e.initial_value,a.min=e.min,a.max=e.max,a.evId=e.ev_id,a.accessNode=e.node,a.accessType=this.convert2AccessType(e.access_type),a.attributes=new Map,a.valueTable=null,a.dataBytesLength=null,a.description=null,a.unit=e.unit,t.environmentVariables.set(a.name,a)}addMessage(t,e){const a={};a.id=e.id,a.dlc=e.dlc,a.name=e.name,a.sendingNode=e.node,a.signals=new Map,a.description=null,a.attributes=new Map,a.signalGroups=new Map,t.messages.set(a.name,a)}addSignal(t,e){const a={};a.name=e.name,a.endian="Motorola"===e.endian?"Motorola":"Intel",a.startBit=e.start_bit,a.length=e.length,a.signed=e.signed,a.max=e.max,a.min=e.min,a.factor=e.factor,a.offset=e.offset,a.multiplex=e.multiplex,a.receivingNodes=e.nodes,a.unit=e.unit,a.valueTable=null,a.description=null,a.attributes=new Map,a.dataType=B(a.length,a.signed);const n=Array.from(t.messages.keys()),i=n[n.length-1];let r;t.messages.has(i)&&(r=t.messages.get(i),null==r||r.signals.set(a.name,a))}addSignalComment(t,e){const a=this.getMessageNameFromId(t,e.id);if(a){const n=t.messages.get(a),i=null==n?void 0:n.signals.get(e.name);i&&(i.description=e.comment)}}addEnvironmentVariableComment(t,e){const a=t.environmentVariables.get(e.name);a&&(a.description=e.comment)}addMessageComment(t,e){const a=this.getMessageNameFromId(t,e.id);if(a){const n=t.messages.get(a);n&&(n.description=e.comment)}}addNodeComment(t,e){const a=t.nodes.get(e.name);a&&(a.description=e.comment)}addVersion(t,e){t.version=e.version}addNewSymbolValue(t,e){t.newSymbols.push(e.symbol)}addEnvironmentVal(t,e){const a=t.environmentVariables.get(e.name);a&&(a.valueTable=e.enum)}addVal(t,e){for(const[a,n]of t.messages){const n=t.messages.get(a);if(n&&n.id===e.id){const t=n.signals.get(e.name),a=e.enum;return void(t&&(t.valueTable=a))}}}addValTable(t,e){var a;const n=e.enum;null===(a=t.valueTables)||void 0===a||a.set(e.name,n)}convert2AttributeType(t){switch(t){case"INT":return"INT";case"STRING":default:return"STRING";case"FLOAT":return"FLOAT";case"ENUM":return"ENUM";case"HEX":return"HEX"}}addGlobalAttribute(t,e){const a={},n=this.convert2AttributeType(e.type);a.name=e.name,a.type="Global",a.dataType=n,a.options=new Array,a.defaultValue=null,a.value=null,a.min="FLOAT"===n||"INT"===n||"HEX"===n?e.min:null,a.max="FLOAT"===n||"INT"===n||"HEX"===n?e.max:null,a.options="ENUM"===n?e.enum:null,a.name&&""!==a.name&&t.attributes.set(a.name,a)}addMessageAttribute(t,e){const a={},n=this.convert2AttributeType(e.type);a.name=e.name,a.type="Message",a.dataType=this.convert2AttributeType(e.type),a.options=new Array,a.defaultValue=null,a.value=null,a.min="FLOAT"===n||"INT"===n||"HEX"===n?e.min:null,a.max="FLOAT"===n||"INT"===n||"HEX"===n?e.max:null,a.options="ENUM"===n?e.enum:null,a.name&&""!==a.name&&t.attributes.set(a.name,a)}addSignalAttribute(t,e){const a={},n=this.convert2AttributeType(e.type);a.name=e.name,a.type="Signal",a.dataType=this.convert2AttributeType(e.type),a.options=new Array,a.defaultValue=null,a.value=null,a.min="FLOAT"===n||"INT"===n||"HEX"===n?e.min:null,a.max="FLOAT"===n||"INT"===n||"HEX"===n?e.max:null,a.options="ENUM"===n?e.enum:null,a.name&&""!==a.name&&t.attributes.set(a.name,a)}addNodeAttribute(t,e){const a={},n=this.convert2AttributeType(e.type);a.name=e.name,a.type="Node",a.dataType=this.convert2AttributeType(e.type),a.options=new Array,a.defaultValue=null,a.value=null,a.min="FLOAT"===n||"INT"===n||"HEX"===n?e.min:null,a.max="FLOAT"===n||"INT"===n||"HEX"===n?e.max:null,a.options="ENUM"===n?e.enum:null,a.name&&""!==a.name&&t.attributes.set(a.name,a)}addEnvironmentAttribute(t,e){const a={},n=this.convert2AttributeType(e.type);a.name=e.name,a.type="EnvironmentVariable",a.dataType=this.convert2AttributeType(e.type),a.options=new Array,a.defaultValue=null,a.value=null,a.min="FLOAT"===n||"INT"===n||"HEX"===n?e.min:null,a.max="FLOAT"===n||"INT"===n||"HEX"===n?e.max:null,a.options="ENUM"===n?e.enum:null,a.name&&""!==a.name&&t.attributes.set(a.name,a)}addAttributeDefaultValue(t,e){const a=t.attributes.get(e.name);a&&(a.defaultValue=e.value,a.value=e.value)}addAttributeValue(t,e){const a=t.attributes.get(e.name);if(a){a.value=e.value;const n=this.getMessageNameFromId(t,e.id);switch(e.type){case"Signal":if(n){const i=t.messages.get(n);if(i){const t=i.signals.get(e.signal);t&&t.attributes.set(a.name,a)}}break;case"Message":if(n){const e=t.messages.get(n);e&&e.attributes.set(a.name,a)}break;case"Node":const i=t.nodes.get(e.node);i&&i.attributes.set(a.name,a);break;case"Global":break;case"EnvironmentVariable":const r=t.environmentVariables.get(e.node);r&&r.attributes.set(a.name,a)}}}addMessageTransmitter(t,e){t.networkBridges.set(e.id,e.nodes)}addSignalGroup(t,e){const a=this.getMessageNameFromId(t,e.id);if(a){const n=t.messages.get(a);if(n){const t={name:e.name,id:e.id,groupId:e.group_number,signals:e.signals};n.signalGroups.set(e.name,t)}}}addSignalValType(t,e){const a=this.getMessageNameFromId(t,e.id);if(a){const n=t.messages.get(a);if(n){const t=n.signals.get(e.name);if(t)switch(e.type){case 1:case 2:t.dataType=B(t.length,t.signed,!0)}}}}convert2EnvType(t){switch(t){case"0":return"Integer";case"1":return"Float";default:return"String"}}convert2AccessType(t){switch(t.trim().slice(-1)){case"0":return"Unrestricted";case"1":default:return"Read";case"2":return"Write";case"3":return"ReadWrite"}}getMessageNameFromId(t,e){const a=Array.from(t.messages.keys());let n=null;for(const i of a){const a=t.messages.get(i);if(a&&a.id===e){n=i;break}}return n}hasKindProp(t){return"object"==typeof t&&null!==t&&"kind"in t}}class D{constructor(){this.dbcString=""}constructFile(t){return this.dbcString="",this.writeVersion(t.version?t.version:""),this.writeNamespace(t.newSymbols),this.writeBusSpeed(t.busSpeed),this.writeNodes(Array.from(t.nodes.keys())),t.valueTables&&this.writeValTable(t.valueTables),this.writeMessagesAndSignals(t.messages),this.writeMessageTransmitters(t.networkBridges),t.description&&this.writeBaseComment(t.description),this.writeMessageAndSignalComments(t.messages),this.writeAttributeDefinitions(t),this.writeAttributeDefaults(t),this.writeAttributeValues(t),this.writeSignalGroups(t.messages),this.writeSignalTables(t.messages),this.writeEnvVarTables(t.environmentVariables),this.writeSignalDataType(t.messages),this.dbcString}writeVersion(t){const e=`VERSION "${t}"`;this.writeLine(e),this.writeLine("")}writeMessageTransmitters(t){t.forEach(((t,e)=>{const a=`BO_TX_BU_ ${e} : ${t.join(",")};`;this.writeLine(a),this.writeLine("")})),this.writeLine("")}writeNamespace(t=null){this.writeLine("NS_:"),t&&t.forEach((t=>{this.writeLine(`    ${t}`)})),this.writeLine("")}writeBusSpeed(t){let e="";e=null===t?"BS_:":`BS_: ${t}`,this.writeLine(e),this.writeLine("")}writeNodes(t){let e="";e=null===t||0===t.length?"BU_:":`BU_: ${t.join(" ")}`,this.writeLine(e),this.writeLine("")}writeSignalGroups(t){t.forEach((t=>{t.signalGroups.forEach((t=>{const e=t.signals.join(" "),a=`SIG_GROUP_ ${t.id} ${t.name} ${t.groupId} : ${e};`;this.writeLine(a)}))})),this.writeLine("")}writeMessagesAndSignals(t){for(const[e,a]of t){let t;t=a.sendingNode?a.sendingNode:"Vector___XXX";const e=`BO_ ${a.id.toString()} ${a.name}: ${a.dlc.toString()} ${t}`;this.writeLine(e);for(const[t,e]of a.signals)this.writeSignal(e);this.writeLine("")}}writeSignal(t){const e="Motorola"===t.endian?"0":"1",a=t.signed?"-":"+",n=0===t.receivingNodes.length?"Vector___XXXX":t.receivingNodes.join(","),i=` SG_ ${t.multiplex?t.name+" "+t.multiplex:t.name} : ${t.startBit.toString()}|${t.length.toString()}@${e}${a} (${t.factor.toString()},${t.offset.toString()}) [${t.min.toString()}|${t.max.toString()}] "${t.unit}" ${n}`;this.writeLine(i)}writeBaseComment(t){this.writeLine(`CM_ "${t}" ;`)}writeMessageAndSignalComments(t){for(const[e,a]of t){a.description&&this.writeLine(`CM_ BO_ ${a.id.toString()} "${a.description}" ;`);for(const[t,e]of a.signals)e.description&&this.writeLine(`CM_ SG_ ${a.id.toString()} ${t} "${e.description}" ;`)}}generateEnumTable(t){let e="";for(const[a,n]of t)e=e+a.toString()+" "+`"${n}" `;return`${e}`}writeValTable(t){for(const[e,a]of t){const t=`VAL_TABLE_ ${e} ${this.generateEnumTable(a)};`;this.writeLine(t)}this.writeLine("")}writeSignalTables(t){for(const[e,a]of t)for(const[t,e]of a.signals)if(e.valueTable){const t=this.generateEnumTable(e.valueTable),n=`VAL_ ${a.id.toString()} ${e.name} ${t};`;this.writeLine(n)}this.writeLine("")}writeEnvVarTables(t){t.forEach((t=>{if(t.valueTable){const e=this.generateEnumTable(t.valueTable),a=`VAL_ ${t.name} ${e};`;this.writeLine(a)}}))}enumListToString(t){return t.reduce(((t,e,a)=>{let n="";return n=0===a?`"${e.trim()}"`:`, "${e.trim()}"`,t+n}),"")}createAttributeDefinitionStr(t,e){let a;switch(a=e?`BA_DEF_ ${e} "${t.name}" ${t.dataType}`:`BA_DEF_ "${t.name}" ${t.dataType}`,t.dataType){case"INT":case"FLOAT":case"HEX":a+=` ${t.min} ${t.max};`;break;case"ENUM":t.options&&(a=a+" "+this.enumListToString(t.options)+";");break;case"STRING":a+=";"}return a}writeAttributeDefinitions(t){t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefinitionStr(t,null))})),t.nodes.forEach((t=>{t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefinitionStr(t,"BU_"))}))}));const e=t.messages;e.forEach((t=>{t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefinitionStr(t,"BO_"))}))})),e.forEach((t=>{const e=t.signals;e&&e.forEach(((t,e)=>{t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefinitionStr(t,"SG_"))}))}))})),this.writeLine("")}createAttributeDefaultString(t){let e=`BA_DEF_DEF_ "${t.name}"`;switch(t.dataType){case"STRING":case"ENUM":e+=` "${t.defaultValue}";`;break;default:e+=` ${t.defaultValue};`}return e}writeAttributeDefaults(t){t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefaultString(t))})),t.nodes.forEach((t=>{t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefaultString(t))}))}));const e=t.messages;e.forEach((t=>{t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefaultString(t))}))})),e.forEach((t=>{const e=t.signals;e&&e.forEach(((t,e)=>{t.attributes.forEach(((t,e)=>{this.writeLine(this.createAttributeDefaultString(t))}))}))})),this.writeLine("")}createAttributeValueString(t,e,a,n,i){let r=`BA_ "${t.name}"`;if(!e)return"STRING"===t.dataType?r+=` "${t.value}";`:r+=` ${t.value};`,r;switch(e){case"BU_":"STRING"===t.dataType?r+=` ${e} ${n} "${t.value}";`:r+=` ${e} ${n} ${t.value};`;break;case"BO_":"STRING"===t.dataType?r+=` ${e} ${a} "${t.value}";`:r+=` ${e} ${a} ${t.value};`;break;case"SG_":"STRING"===t.dataType?r+=` ${e} ${a} ${i} "${t.value}";`:r+=` ${e} ${a} ${i} ${t.value};`}return r}writeAttributeValues(t){t.attributes.forEach(((t,e)=>{t.defaultValue!==t.value&&this.writeLine(this.createAttributeValueString(t,null,null,null,null))})),t.nodes.forEach((t=>{t.attributes.forEach(((e,a)=>{e.defaultValue!==e.value&&this.writeLine(this.createAttributeValueString(e,"BU_",null,t.name,null))}))}));const e=t.messages;e.forEach((t=>{t.attributes.forEach(((e,a)=>{e.defaultValue!==e.value&&this.writeLine(this.createAttributeValueString(e,"BO_",t.id,null,null))}))})),e.forEach((t=>{const e=t.signals;e&&e.forEach(((e,a)=>{e.attributes.forEach(((a,n)=>{a.defaultValue!==a.value&&this.writeLine(this.createAttributeValueString(a,"SG_",t.id,null,e.name))}))}))})),this.writeLine("")}writeSignalDataType(t){for(const[e,a]of t)for(const[t,e]of a.signals)if(e.dataType&&("float"===e.dataType||"double"===e.dataType)){let t;t="double"===e.dataType?"2":"1";const n=`SIG_VALTYPE_ ${a.id.toString()} ${e.name} : ${t};`;this.writeLine(n)}this.writeLine("")}writeLine(t){this.dbcString+=`${t}\n`}}class L extends Error{constructor(t){super(t),this.__proto__=Error,Object.setPrototypeOf(this,L.prototype)}}class F extends Error{constructor(t){super(t),this.__proto__=Error,Object.setPrototypeOf(this,F.prototype)}}class R extends Error{constructor(t){super(t),this.__proto__=Error,Object.setPrototypeOf(this,R.prototype)}}class O{bitGet(t,e){return this.uint8ToBinary(t).split("")[e]}bitSet(t,e,a){return t[t.length-e-1]=a,t}bin2decSigned(t){if("1"===t[0]){let e="";for(let a=0;a<t.length;a++)e+="0"===t[a]?"1":"0";return-1*(parseInt(e,2)+1)}return parseInt(t,2)}bin2dec(t){return parseInt(t,2)}uint8ToBinary(t){const e="000000000"+(t>>>0).toString(2);return e.substring(e.length-8)}payload2Binary(t,e){let a;a="Intel"===e?t.slice().reverse():t;return a.reduce(((t,e)=>t+this.uint8ToBinary(e)),"").split("")}extractBitRange(t,e,a,n){let i;if("Intel"===n)i=t.length-e-a;else{i=8*Math.floor(e/8)+(7-e%8)-a+1}return t.slice(i,i+a)}}t.Can=class extends O{constructor(){super(),this.idMap=new Map}set database(t){this._database=t,this.idMap=this.messageMapTransform(this._database.messages)}messageMapTransform(t){const e=new Map;for(const[a,n]of t)e.set(n.id,n);return e}createFrame(t,e,a=!1){if(e.length>8)throw new R(`Can not have payloads over 8 bytes: ${e}`);if(0===e.length)throw new R(`Payload is either empty or undefined: ${e}`);const n=new Uint8ClampedArray(e);return{id:t,dlc:e.length,isExtended:a,payload:Array.from(n)}}decode(t){if(void 0===this._database)throw new Error("No database is attached to class instance");const e=this.getMessageById(t.id);if(!e)return e;if(e.dlc!==t.dlc)return;const a=new Map;for(const[n,i]of e.signals){const e=this.decodeSignal(t.payload,i);a.set(n,e)}return{name:e.name,id:e.id,boundSignals:a,boundData:{frame:t,message:e},setSignalValue:(t,e)=>({})}}getMessageById(t){return this.idMap.get(t)}applyPropsToSignalValue(t,e){let a,n=e*t.factor+t.offset;if(0===t.min&&0===t.max||(n<t.min?n=t.min:n>t.max&&(n=t.max)),t.valueTable){const e=t.valueTable.get(n);a=e||n.toString()+(t.unit?" "+t.unit:"")}else a=n.toString()+(t.unit?" "+t.unit:"");return{rawValue:e,prcValue:n,physValue:a}}decodeSignal(t,e){const a=this.extractValFromPayload(t,e.startBit,e.length,e.endian,e.signed),n=this.applyPropsToSignalValue(e,a);return{boundData:{payload:t,signal:e},setValue:t=>({}),value:n.prcValue,rawValue:n.rawValue,physValue:n.physValue}}extractValFromPayload(t,e,a,n,i){const r=this.payload2Binary(t,n),s=this.extractBitRange(r,e,a,n);let l;return l=Number(i?this.bin2decSigned(s.join("")):this.bin2dec(s.join(""))),l}setSignalValues(){return null}createBoundSignal(t,e,a=0){const n=this.applyPropsToSignalValue(t,a),i={boundData:{signal:t,payload:e},value:n.prcValue,rawValue:n.rawValue,physValue:n.physValue,setValue:e=>{const a=this.applyPropsToSignalValue(t,e);i.value=a.prcValue,i.rawValue=a.rawValue,i.physValue=a.physValue}};return i}createBoundMessage(t,e=null){let a,n;if(e&&e.payload){if(e.payload.length!==t.dlc)throw new Error(`Supplied payload length: ${e.payload.length} does not match message DLC length: ${t.dlc}`);a=e.payload}else a=new Array(t.dlc).fill(0);n=!(!e||!e.isExtended)&&e.isExtended;const i=this.createFrame(t.id,a,n),r=new Map;t.signals.forEach((t=>{r.set(t.name,this.createBoundSignal(t,a,0))}));const s={name:t.name,id:t.id,boundSignals:r,boundData:{frame:i,message:t},setSignalValue:(t,e)=>{const a=s.boundSignals.get(t);a&&a.setValue(e)}};return s}},t.Dbc=class{constructor(){this.errors=new Map,this.data=this.initDbcDataObj()}set version(t){this.data.version=t}set description(t){this.data.description=t}createNode(t,e){let a,n;a=e&&e.description?e.description:null,n=e&&e.attributes?e.attributes:new Map;const i={name:t,description:a,attributes:n,add:()=>(this.data.nodes.set(i.name,i),i),updateDescription:t=>(i.description=t,i),addAttribute:(t,e,a,n)=>{a?a.type="Node":a={type:"Node"};const r=this.createAttribute(t,e,a,n);return this.addAttribute(r,{node:i.name}),i}};return i}createMessage(t,e,a,n){let i,r,s,l,c;i=n&&n.signals?n.signals:new Map,r=n&&n.attributes?n.attributes:new Map,s=n&&n.signalGroups?n.signalGroups:new Map,c=n&&n.description?n.description:null,l=n&&n.sendingNode?n.sendingNode:null,l&&this.createNode(l).add();const o={name:t,id:e,dlc:a,sendingNode:l,signals:i,description:c,attributes:r,signalGroups:s,add:()=>(this.addMessage(o),o),addSignal:(t,e,a,n)=>{const i=this.createSignal(t,e,a,n);return this.addSignal(o.name,i),o},updateDescription:t=>(o.description=t,o),updateNode:t=>(o.sendingNode=t,this.createNode(t).add(),o),addAttribute:(t,e,a,n)=>{a?a.type="Message":a={type:"Message"};const i=this.createAttribute(t,e,a,n);return this.addAttribute(i,{id:o.id}),o}};return o}addMessage(t){const e=t=>{if(this.data.messages.has(t))throw new Error(`Can not add message ${t} as ${t} already exists. Unique message names are required.`)};Array.isArray(t)?t.forEach((t=>{e(t.name),this.data.messages.set(t.name,t)})):(e(t.name),this.data.messages.set(t.name,t))}removeMessage(t){if(!this.data.messages.delete(t))throw new Error(`${t} does not exist in the database`)}createSignal(t,e,a,n){let i,r,s,l,c,o,h,u,m,g,d,p,_,b;o=!(!n||!n.signed)&&n.signed,h=n&&n.endian?n.endian:"Intel",i=n&&n.min?n.min:0,r=n&&n.max?n.max:0,l=n&&n.offset?n.offset:0,s=n&&n.factor?n.factor:1,c=!(!n||!n.isFloat)&&n.isFloat,m=n&&n.unit?n.unit:"",g=n&&n.description?n.description:null,d=n&&n.multiplex?n.multiplex:null,p=n&&n.receivingNodes?n.receivingNodes:[],_=n&&n.valueTable?n.valueTable:null,b=n&&n.attributes?n.attributes:new Map,u=B(a,o,c),p.length&&p.forEach((t=>{this.createNode(t).add()}));const S={name:t,multiplex:d,startBit:e,length:a,endian:h,signed:o,factor:s,offset:l,min:i,max:r,unit:m,receivingNodes:p,description:g,valueTable:_,attributes:b,dataType:u,add:t=>(this.addSignal(t,S),S),updateDescription:t=>(S.description=t,S),addAttribute:(t,e,a,n,i)=>{n?n.type="Signal":n={type:"Signal"};const r=this.createAttribute(t,a,n,i);return this.addAttribute(r,{id:e,signalName:S.name}),S}};return S}removeSignal(t,e){const a=this.getMessageByName(e);if(a){if(!a.signals.delete(t))throw new Error(`${t} does not exist in message ${e}`)}}addSignal(t,e){const a=this.data.messages.get(t);if(!a)throw new L(`No message with name ${t} exists in the database.`);Array.isArray(e)?e.forEach((t=>{a.signals.set(t.name,t)})):a.signals.set(e.name,e)}getMessageById(t){const e=this.data.messages;for(const[a,n]of e)if(n.id===t)return n;throw new L(`No message with id ${t} exists in the database.`)}getMessageByName(t){try{return this.data.messages.get(t)}catch(e){throw new L(`No message with name ${t} exists in the database.`)}}getSignalByName(t,e){const a=this.getMessageByName(e),n=null==a?void 0:a.signals;if(!n)throw new F(`Signal could not be found in ${e}, because the\n      signal list for that message is empty.`);for(const[e,a]of n)if(e===t)return a;throw new F(`Could not find ${t} in signal list.`)}createAttribute(t,e,a,n){let i="Global",r=null,s=null,l=null,c=null,o=null;if(a){if(a.type&&(i=a.type),"ENUM"===e&&!a.enumMembers)throw new Error("enumMembers is a required property when defining an attribute with type ENUM");if("ENUM"===e&&a.enumMembers&&(r=a.enumMembers),"ENUM"!==e&&"STRING"!==e&&!a.min&&!a.max)throw new Error("min and max are required properties when defining anything other than type ENUM and STRING");void 0!==a.min&&(s=a.min),void 0!==a.max&&(l=a.max),n&&(void 0!==n.defaultValue?o=n.defaultValue:void 0!==n.value&&void 0===n.defaultValue&&(c=n.value,o=c))}else if(!a&&"STRING"!==e)throw new Error("Additional attribute properties are required for any type other than STRING");return{name:t,type:i,dataType:e,min:s,max:l,options:r,value:c,defaultValue:o}}addAttribute(t,e){switch(t.type){case"Message":if(e&&!e.id)throw new Error("ID is a required option for adding a Message attribute");if(null==e?void 0:e.id){this.getMessageById(e.id).attributes.set(t.name,t)}break;case"Signal":if(e&&!e.id||!(null==e?void 0:e.signalName))throw new Error("Signal name/and message ID are required options for adding a Signal attribute");if((null==e?void 0:e.id)&&(null==e?void 0:e.signalName)){this.getSignalByName(e.signalName,this.messageIdToName(e.id)).attributes.set(t.name,t)}break;case"Node":if(e&&!e.node)throw new Error("Node name is a required option for adding a Node attribute");if(null==e?void 0:e.node){this.getNode(e.node).attributes.set(t.name,t)}break;case"EnvironmentVariable":if(e&&!e.evName)throw new Error("Environmental Variable name is a required option for adding EV Attribute");if(null==e?void 0:e.evName){this.getEnvironmentalVariable(e.evName).attributes.set(t.name,t)}break;case"Global":this.data.attributes.set(t.name,t)}}getEnvironmentalVariable(t){const e=this.data.environmentVariables.get(t);if(!e)throw new Error("${name} is not an existing environmental variable in the database");return e}getNode(t){const e=this.data.nodes.get(t);if(!e)throw new Error(`${t} is not an existing node in the database`);return e}messageIdToName(t){const e=this.getMessageById(t).name;if(!e)throw new Error(`Could not find ${t} in the database`);return e}load(t,e=!1){let a=this.initDbcDataObj(),n=1;const i=new Map;return t.split("\n").forEach((t=>{const r=new I(t),s=r.parseResult.errs;if(0===s.length)a=r.updateData(a);else{if(e)throw new Error(`A syntax error occurred on line ${n} - Reason: ${s}`);i.set(n,s)}n++})),Array.from(a.attributes.entries()).forEach((([t,e])=>{"Global"!==e.type&&a.attributes.delete(t)})),this.errors=i,this.data=a,a}write(){const t=new D;return t.constructFile(this.data),t.dbcString}toJson(t){const e=(t,e)=>e instanceof Map?"valueTable"===t||"valueTables"===t?Object.fromEntries(e.entries()):Array.from(e.values()):e;let a,n,i=0;return a=!t||!t.pretty||t.pretty,a&&(i=2),n=t&&t.preserveFormat?JSON.stringify(this.data,void 0,i):JSON.stringify(this.data,e,i),n}initDbcDataObj(){return{version:null,messages:new Map,description:null,busSpeed:null,nodes:new Map,valueTables:new Map,attributes:new Map,newSymbols:[],environmentVariables:new Map,networkBridges:new Map}}}}));
